<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Invoice on Calyrium.org</title>
    <link>localhost/tags/invoice/</link>
    <description>Recent content in Invoice on Calyrium.org</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>de-DE</language>
    <managingEditor>admin@calyrium.org (Sebastian Preisner)</managingEditor>
    <webMaster>admin@calyrium.org (Sebastian Preisner)</webMaster>
    <copyright>Copyright 2016 calyrium.org</copyright>
    <lastBuildDate>Sun, 22 May 2016 12:16:00 +0000</lastBuildDate>
    <atom:link href="localhost/tags/invoice/index.xml" rel="self" type="application/rss+xml" />
    
    <item>
      <title>Install Invoiceninja Archlinux with Nginx</title>
      <link>/localhost/post/install-invoiceninja-archlinux-nginx/</link>
      <pubDate>Sun, 22 May 2016 12:16:00 +0000</pubDate>
      <author>admin@calyrium.org (Sebastian Preisner)</author>
      <guid>/localhost/post/install-invoiceninja-archlinux-nginx/</guid>
      <description>

&lt;p&gt;In this tutorial i’ll see how to install Invoice Ninja on a Arch Linux VPS with MariaDB, PHP-FPM and Nginx. Invoice Ninja is a free, open-source solution for invoicing and billing customers and it’s based on Laravel framework.&lt;/p&gt;

&lt;h2 id=&#34;installing-required-software:d35f1845b52303c388554e725b683ac8&#34;&gt;Installing Required Software&lt;/h2&gt;

&lt;p&gt;First you must Login to your System via SSH:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;ssh user@myVPS
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Requirements:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;nginx&lt;/li&gt;
&lt;li&gt;php-fpm&lt;/li&gt;
&lt;li&gt;php-mcrypt&lt;/li&gt;
&lt;li&gt;php-gd&lt;/li&gt;
&lt;li&gt;php-composer&lt;/li&gt;
&lt;li&gt;git&lt;/li&gt;
&lt;li&gt;curl&lt;/li&gt;
&lt;li&gt;openssl&lt;/li&gt;
&lt;li&gt;mariadb&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;First update the system:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;pacman -Syu
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;setup-mariadb:d35f1845b52303c388554e725b683ac8&#34;&gt;Setup MariaDB&lt;/h2&gt;

&lt;p&gt;Installing MariaDB (&lt;a href=&#34;https://wiki.archlinux.org/index.php/MySQL#Installation&#34;&gt;More Information on Archlinux.org&lt;/a&gt;
):&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;pacman -S mariadb
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;When the installation is complete, run the following command to secure your installation:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;mysql_secure_installation
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Next, we need to create a database for our Invoice Ninja instance.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;mysql -u root -p
MariaDB [(none)]&amp;gt; CREATE DATABASE ininja;
MariaDB [(none)]&amp;gt; GRANT ALL PRIVILEGES ON ininja.* TO &#39;ininjauser&#39;@&#39;localhost&#39; IDENTIFIED BY &#39;ininjauser_passwd&#39;;
MariaDB [(none)]&amp;gt; FLUSH PRIVILEGES;
MariaDB [(none)]&amp;gt; \q
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;install-and-configure-php-and-nginx:d35f1845b52303c388554e725b683ac8&#34;&gt;Install and configure PHP and Nginx&lt;/h2&gt;

&lt;p&gt;You should install Nginx, PHP and all necessary extensions:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;pacman -S nginx php php-mcrypt php-gd php-composer
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Uncomment the following Modules for PHP &lt;code&gt;vim /etc/php/php.ini&lt;/code&gt;:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;extension=curl.so
extension=gd.so
extension=gmp.so
extension=iconv.so 
extension=mcrypt.so 
extension=pdo_mysql.so
extension=zip.so
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;setup-nginx:d35f1845b52303c388554e725b683ac8&#34;&gt;Setup Nginx&lt;/h3&gt;

&lt;p&gt;Generate SSL certificate:&lt;/p&gt;

&lt;div class=&#34;highlight&#34; style=&#34;background: #f0f0f0&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;&lt;span&gt;&lt;/span&gt;mkdir -p /etc/nginx/ssl
&lt;span style=&#34;color: #007020&#34;&gt;cd&lt;/span&gt; /etc/nginx/ssl
openssl genrsa -des3 -passout pass:x -out ininja.pass.key 2048
openssl rsa -passin pass:x -in ininja.pass.key -out ininja.key
rm ininja.pass.key
openssl req -new -key ininja.key -out ininja.csr
openssl x509 -req -days &lt;span style=&#34;color: #40a070&#34;&gt;365&lt;/span&gt; -in ininja.csr -signkey ininja.key -out ininja.crt
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Create a new Nginx Serverblock &lt;code&gt;vim /etc/nginx/sites-availeble/invoiceninja&lt;/code&gt;:&lt;/p&gt;

&lt;div class=&#34;highlight&#34; style=&#34;background: #f0f0f0&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span style=&#34;color: #007020; font-weight: bold&#34;&gt;server&lt;/span&gt; {
    &lt;span style=&#34;color: #007020; font-weight: bold&#34;&gt;listen&lt;/span&gt;  &lt;span style=&#34;color: #40a070&#34;&gt;80&lt;/span&gt;;
    &lt;span style=&#34;color: #007020; font-weight: bold&#34;&gt;listen&lt;/span&gt;  &lt;span style=&#34;color: #4070a0&#34;&gt;[::]:80&lt;/span&gt; &lt;span style=&#34;color: #4070a0&#34;&gt;ipv6only=on&lt;/span&gt;;
    &lt;span style=&#34;color: #007020; font-weight: bold&#34;&gt;server_name&lt;/span&gt; &lt;span style=&#34;color: #4070a0&#34;&gt;my_invoiceninja.domain.tld&lt;/span&gt;;
    
    &lt;span style=&#34;color: #60a0b0; font-style: italic&#34;&gt;# Return all requests to https&lt;/span&gt;
    &lt;span style=&#34;color: #007020; font-weight: bold&#34;&gt;return&lt;/span&gt;  &lt;span style=&#34;color: #4070a0&#34;&gt;https://&lt;/span&gt;&lt;span style=&#34;color: #bb60d5&#34;&gt;$host$request_uri&lt;/span&gt;;
}
&lt;span style=&#34;color: #007020; font-weight: bold&#34;&gt;server&lt;/span&gt; {
    &lt;span style=&#34;color: #007020; font-weight: bold&#34;&gt;listen&lt;/span&gt;  &lt;span style=&#34;color: #40a070&#34;&gt;443&lt;/span&gt;;
    &lt;span style=&#34;color: #007020; font-weight: bold&#34;&gt;listen&lt;/span&gt;  &lt;span style=&#34;color: #4070a0&#34;&gt;[::]:443&lt;/span&gt; &lt;span style=&#34;color: #4070a0&#34;&gt;ipv6only=on&lt;/span&gt;;
    &lt;span style=&#34;color: #007020; font-weight: bold&#34;&gt;server_name&lt;/span&gt; &lt;span style=&#34;color: #4070a0&#34;&gt;my_invoiceninja.domain.tld&lt;/span&gt;;
    
    &lt;span style=&#34;color: #007020; font-weight: bold&#34;&gt;ssl&lt;/span&gt; &lt;span style=&#34;color: #60add5&#34;&gt;on&lt;/span&gt;;
    &lt;span style=&#34;color: #007020; font-weight: bold&#34;&gt;ssl_certificate&lt;/span&gt;     &lt;span style=&#34;color: #4070a0&#34;&gt;/etc/nginx/ssl/ininja.crt&lt;/span&gt;;
    &lt;span style=&#34;color: #007020; font-weight: bold&#34;&gt;ssl_certificate_key&lt;/span&gt; &lt;span style=&#34;color: #4070a0&#34;&gt;/etc/nginx/ssl/ininja.key&lt;/span&gt;;
    &lt;span style=&#34;color: #007020; font-weight: bold&#34;&gt;ssl_session_timeout&lt;/span&gt; &lt;span style=&#34;color: #40a070&#34;&gt;5m&lt;/span&gt;;

    &lt;span style=&#34;color: #007020; font-weight: bold&#34;&gt;ssl_ciphers&lt;/span&gt;                 &lt;span style=&#34;color: #4070a0&#34;&gt;&amp;#39;AES128+EECDH:AES128+EDH:!aNULL&amp;#39;&lt;/span&gt;;
    &lt;span style=&#34;color: #007020; font-weight: bold&#34;&gt;ssl_protocols&lt;/span&gt;               &lt;span style=&#34;color: #4070a0&#34;&gt;TLSv1&lt;/span&gt; &lt;span style=&#34;color: #4070a0&#34;&gt;TLSv1.1&lt;/span&gt; &lt;span style=&#34;color: #4070a0&#34;&gt;TLSv1.2&lt;/span&gt;;
    &lt;span style=&#34;color: #007020; font-weight: bold&#34;&gt;ssl_prefer_server_ciphers&lt;/span&gt;   &lt;span style=&#34;color: #60add5&#34;&gt;on&lt;/span&gt;;
    
    &lt;span style=&#34;color: #007020; font-weight: bold&#34;&gt;charset&lt;/span&gt; &lt;span style=&#34;color: #4070a0&#34;&gt;utf-8&lt;/span&gt;; 
    
    &lt;span style=&#34;color: #007020; font-weight: bold&#34;&gt;root&lt;/span&gt; &lt;span style=&#34;color: #4070a0&#34;&gt;/srv/http/your_ninja_site/public&lt;/span&gt;;
    &lt;span style=&#34;color: #007020; font-weight: bold&#34;&gt;index&lt;/span&gt; &lt;span style=&#34;color: #4070a0&#34;&gt;index.php&lt;/span&gt; &lt;span style=&#34;color: #4070a0&#34;&gt;index.html&lt;/span&gt; &lt;span style=&#34;color: #4070a0&#34;&gt;index.htm&lt;/span&gt;;
    
    &lt;span style=&#34;color: #60a0b0; font-style: italic&#34;&gt;## Invoiceninja Settings&lt;/span&gt;
    &lt;span style=&#34;color: #007020; font-weight: bold&#34;&gt;location&lt;/span&gt; &lt;span style=&#34;color: #4070a0&#34;&gt;/&lt;/span&gt; {
        &lt;span style=&#34;color: #007020; font-weight: bold&#34;&gt;try_files&lt;/span&gt; &lt;span style=&#34;color: #bb60d5&#34;&gt;$uri&lt;/span&gt; &lt;span style=&#34;color: #bb60d5&#34;&gt;$uri/&lt;/span&gt; &lt;span style=&#34;color: #4070a0&#34;&gt;/index.php?&lt;/span&gt;&lt;span style=&#34;color: #bb60d5&#34;&gt;$query_string&lt;/span&gt;;
    }
    
    &lt;span style=&#34;color: #007020; font-weight: bold&#34;&gt;location&lt;/span&gt; = &lt;span style=&#34;color: #4070a0&#34;&gt;/favicon.ico&lt;/span&gt; { &lt;span style=&#34;color: #007020; font-weight: bold&#34;&gt;access_log&lt;/span&gt; &lt;span style=&#34;color: #60add5&#34;&gt;off&lt;/span&gt;; &lt;span style=&#34;color: #007020; font-weight: bold&#34;&gt;log_not_found&lt;/span&gt; &lt;span style=&#34;color: #60add5&#34;&gt;off&lt;/span&gt;; }
    &lt;span style=&#34;color: #007020; font-weight: bold&#34;&gt;location&lt;/span&gt; = &lt;span style=&#34;color: #4070a0&#34;&gt;/robots.txt&lt;/span&gt;  { &lt;span style=&#34;color: #007020; font-weight: bold&#34;&gt;access_log&lt;/span&gt; &lt;span style=&#34;color: #60add5&#34;&gt;off&lt;/span&gt;; &lt;span style=&#34;color: #007020; font-weight: bold&#34;&gt;log_not_found&lt;/span&gt; &lt;span style=&#34;color: #60add5&#34;&gt;off&lt;/span&gt;; }
    
    &lt;span style=&#34;color: #007020; font-weight: bold&#34;&gt;access_log&lt;/span&gt;  &lt;span style=&#34;color: #4070a0&#34;&gt;/var/log/nginx/ininja.access.log&lt;/span&gt;;
    &lt;span style=&#34;color: #007020; font-weight: bold&#34;&gt;error_log&lt;/span&gt;   &lt;span style=&#34;color: #4070a0&#34;&gt;/var/log/nginx/ininja.error.log&lt;/span&gt;;
    
    &lt;span style=&#34;color: #007020; font-weight: bold&#34;&gt;sendfile&lt;/span&gt; &lt;span style=&#34;color: #60add5&#34;&gt;off&lt;/span&gt;;
    
    &lt;span style=&#34;color: #007020; font-weight: bold&#34;&gt;location&lt;/span&gt; ~ &lt;span style=&#34;color: #235388&#34;&gt;/\.ht&lt;/span&gt; {
        &lt;span style=&#34;color: #007020; font-weight: bold&#34;&gt;deny&lt;/span&gt; &lt;span style=&#34;color: #4070a0&#34;&gt;all&lt;/span&gt;; 
    }
    
    &lt;span style=&#34;color: #60a0b0; font-style: italic&#34;&gt;## FastCGI Setting&lt;/span&gt;
    &lt;span style=&#34;color: #007020; font-weight: bold&#34;&gt;location&lt;/span&gt; ~ &lt;span style=&#34;color: #235388&#34;&gt;\.php$&lt;/span&gt; {
        &lt;span style=&#34;color: #007020; font-weight: bold&#34;&gt;fastcgi_split_path_info&lt;/span&gt; &lt;span style=&#34;color: #4070a0&#34;&gt;^(.+\.php)(/.+)&lt;/span&gt;$;
        &lt;span style=&#34;color: #007020; font-weight: bold&#34;&gt;if&lt;/span&gt; &lt;span style=&#34;color: #4070a0&#34;&gt;(!-f&lt;/span&gt; &lt;span style=&#34;color: #bb60d5&#34;&gt;$document_root$fastcgi_script_name&lt;/span&gt;&lt;span style=&#34;color: #4070a0&#34;&gt;)&lt;/span&gt; {
            &lt;span style=&#34;color: #007020; font-weight: bold&#34;&gt;return&lt;/span&gt; &lt;span style=&#34;color: #40a070&#34;&gt;404&lt;/span&gt;;
        }
        &lt;span style=&#34;color: #60a0b0; font-style: italic&#34;&gt;# NOTE: You should have &amp;quot;cgi.fix_pathinfo = 0;&amp;quot; in php.ini&lt;/span&gt;
        
        &lt;span style=&#34;color: #007020; font-weight: bold&#34;&gt;fastcgi_pass&lt;/span&gt; &lt;span style=&#34;color: #4070a0&#34;&gt;unix:/run/php-fpm/php-fpm.sock&lt;/span&gt;;
        &lt;span style=&#34;color: #007020; font-weight: bold&#34;&gt;fastcgi_read_timeout&lt;/span&gt; &lt;span style=&#34;color: #40a070&#34;&gt;30m&lt;/span&gt;;
        &lt;span style=&#34;color: #007020; font-weight: bold&#34;&gt;fastcgi_param&lt;/span&gt; &lt;span style=&#34;color: #4070a0&#34;&gt;PATH_INFO&lt;/span&gt; &lt;span style=&#34;color: #bb60d5&#34;&gt;$fastcgi_path_info&lt;/span&gt;;
        &lt;span style=&#34;color: #007020; font-weight: bold&#34;&gt;fastcgi_param&lt;/span&gt; &lt;span style=&#34;color: #4070a0&#34;&gt;SCRIPT_FILENAME&lt;/span&gt; &lt;span style=&#34;color: #bb60d5&#34;&gt;$document_root$fastcgi_script_name&lt;/span&gt;;
        &lt;span style=&#34;color: #007020; font-weight: bold&#34;&gt;fastcgi_index&lt;/span&gt; &lt;span style=&#34;color: #4070a0&#34;&gt;index.php&lt;/span&gt;;
        &lt;span style=&#34;color: #007020; font-weight: bold&#34;&gt;include&lt;/span&gt; &lt;span style=&#34;color: #4070a0&#34;&gt;/etc/nginx/fastcgi_params&lt;/span&gt;;
    }
}
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Activate the server block by creating a symbolic link:
&lt;div class=&#34;highlight&#34; style=&#34;background: #f0f0f0&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;&lt;span&gt;&lt;/span&gt;ln -s /etc/nginx/sites-available/your_ininja_site /etc/nginx/sites-enabled/your_ininja_site
&lt;/pre&gt;&lt;/div&gt;
&lt;/p&gt;

&lt;h3 id=&#34;enable-php-and-nginx:d35f1845b52303c388554e725b683ac8&#34;&gt;Enable PHP and Nginx&lt;/h3&gt;

&lt;pre&gt;&lt;code&gt;systemctl start php-fpm
systemctl start nginx
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;install-invoice-ninja:d35f1845b52303c388554e725b683ac8&#34;&gt;Install Invoice Ninja&lt;/h2&gt;

&lt;p&gt;Create a root directory for your application.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;mkdir -p /srv/http/your_ninja_site
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Clone the project repository from GitHub:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;git clone https://github.com/hillelcoren/invoice-ninja.git /srv/http/your_ininja_site
cd  /srv/http/your_ininja_site
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Install all dependencies:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;composer install
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Set the environment to production:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;cp .env.example .env
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Open the database.php file and edit the database settings &lt;code&gt;vim config/database.php&lt;/code&gt;:&lt;/p&gt;

&lt;p&gt;&lt;div class=&#34;highlight&#34; style=&#34;background: #f0f0f0&#34;&gt;&lt;pre style=&#34;line-height: 125%&#34;&gt;&lt;span&gt;&lt;/span&gt;&lt;span style=&#34;color: #4070a0&#34;&gt;&amp;#39;mysql&amp;#39;&lt;/span&gt; &lt;span style=&#34;color: #666666&#34;&gt;=&amp;gt;&lt;/span&gt; [
        &lt;span style=&#34;color: #4070a0&#34;&gt;&amp;#39;driver&amp;#39;&lt;/span&gt;    &lt;span style=&#34;color: #666666&#34;&gt;=&amp;gt;&lt;/span&gt; &lt;span style=&#34;color: #4070a0&#34;&gt;&amp;#39;mysql&amp;#39;&lt;/span&gt;,
        &lt;span style=&#34;color: #4070a0&#34;&gt;&amp;#39;host&amp;#39;&lt;/span&gt;      &lt;span style=&#34;color: #666666&#34;&gt;=&amp;gt;&lt;/span&gt; &lt;span style=&#34;color: #4070a0&#34;&gt;&amp;#39;localhost&amp;#39;&lt;/span&gt;,
        &lt;span style=&#34;color: #4070a0&#34;&gt;&amp;#39;database&amp;#39;&lt;/span&gt;  &lt;span style=&#34;color: #666666&#34;&gt;=&amp;gt;&lt;/span&gt; &lt;span style=&#34;color: #4070a0&#34;&gt;&amp;#39;ininja&amp;#39;&lt;/span&gt;,
        &lt;span style=&#34;color: #4070a0&#34;&gt;&amp;#39;username&amp;#39;&lt;/span&gt;  &lt;span style=&#34;color: #666666&#34;&gt;=&amp;gt;&lt;/span&gt; &lt;span style=&#34;color: #4070a0&#34;&gt;&amp;#39;ininjauser&amp;#39;&lt;/span&gt;,
        &lt;span style=&#34;color: #4070a0&#34;&gt;&amp;#39;password&amp;#39;&lt;/span&gt;  &lt;span style=&#34;color: #666666&#34;&gt;=&amp;gt;&lt;/span&gt; &lt;span style=&#34;color: #4070a0&#34;&gt;&amp;#39;ininjauser_passwd&amp;#39;&lt;/span&gt;,
        &lt;span style=&#34;color: #4070a0&#34;&gt;&amp;#39;charset&amp;#39;&lt;/span&gt;   &lt;span style=&#34;color: #666666&#34;&gt;=&amp;gt;&lt;/span&gt; &lt;span style=&#34;color: #4070a0&#34;&gt;&amp;#39;utf8&amp;#39;&lt;/span&gt;,
        &lt;span style=&#34;color: #4070a0&#34;&gt;&amp;#39;collation&amp;#39;&lt;/span&gt; &lt;span style=&#34;color: #666666&#34;&gt;=&amp;gt;&lt;/span&gt; &lt;span style=&#34;color: #4070a0&#34;&gt;&amp;#39;utf8_unicode_ci&amp;#39;&lt;/span&gt;,
        &lt;span style=&#34;color: #4070a0&#34;&gt;&amp;#39;prefix&amp;#39;&lt;/span&gt;    &lt;span style=&#34;color: #666666&#34;&gt;=&amp;gt;&lt;/span&gt; &lt;span style=&#34;color: #4070a0&#34;&gt;&amp;#39;&amp;#39;&lt;/span&gt;,
        ],
&lt;/pre&gt;&lt;/div&gt;
&lt;/p&gt;

&lt;p&gt;Run database migrations and seed the database with sample data:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;php artisan migrate
php artisan db:seed
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Generate a new application key:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;php artisan key:generate
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Insert the generated key in the configfile &lt;code&gt;vim config/app.php&lt;/code&gt;:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;&#39;key&#39; =&amp;gt; env(&#39;APP_KEY&#39;, &#39;2DAdHIDKts85n6hTX82mb4GrQpX2TXZ2&#39;),
&lt;/code&gt;&lt;/pre&gt;
</description>
    </item>
    
  </channel>
</rss>