<!DOCTYPE html>
<html lang="" class="no-js">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title></title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="apple-touch-icon" href="apple-touch-icon.png">
    
    <link rel="stylesheet" href="../../css/app.css">
    
    <link href="//fonts.googleapis.com/css?family=Questrial" rel="stylesheet" type="text/css">
    <link href="//fonts.googleapis.com/css?family=Sanchez:400italic,400" rel="stylesheet" type="text/css">
    <script src="js/vendor/modernizr-2.8.3.min.js"></script>
  </head>
  <body>
    
    <input id="togglenav" type="checkbox">
    <section id="header">
      <div id="mobile-nav">
        <label id="togglenav-lable" for="togglenav">Menu</label>
        <h1>Calyrium.org</h1>
      </div>
      <header>
        <div class="avatar">
          <image id="profile-img" src="localhost/img/profile.jpg" class="round"></image>
        </div>
        <div class="name">
          <h1>Calyrium.org</h1>
          <p>@Kreativmonkey</p>
          <ul class="social">
            <li><a href="javascript:void(0)"><img src="https://raw.githubusercontent.com/thoughtbot/refills/master/source/images/facebook-logo-circle.png" alt="Facebook"></a></li>
            <li><a href="javascript:void(0)"><img src="https://raw.githubusercontent.com/thoughtbot/refills/master/source/images/twitter-logo-circle.png" alt="Twitter"></a></li>
            <li><a href="javascript:void(0)"><img src="https://raw.githubusercontent.com/thoughtbot/refills/master/source/images/youtube-logo-circle.png" alt="YouTube"></a></li>
          </ul>
        </div>
      </header>
      <nav role="navigation" id="main-nav">
        <ul class="navigation">
          <li> <a href="#" class="active">Blog  </a></li>
          <li> <a href="#">Portfolio</a></li>
          <li> <a href="#">Impressum</a></li>
        </ul>
      </nav>
    </section>

    <main>
      <article class="blog-article">
        <p class="type">post</p>
        <h1>Install Invoiceninja Archlinux with Nginx</h1>
        <p class="date">May 22, 2016</p>
        

<p>In this tutorial i’ll see how to install Invoice Ninja on a Arch Linux VPS with MariaDB, PHP-FPM and Nginx. Invoice Ninja is a free, open-source solution for invoicing and billing customers and it’s based on Laravel framework.</p>

<h2 id="installing-required-software:d35f1845b52303c388554e725b683ac8">Installing Required Software</h2>

<p>First you must Login to your System via SSH:</p>

<pre><code>ssh user@myVPS
</code></pre>

<p>Requirements:</p>

<ul>
<li>nginx</li>
<li>php-fpm</li>
<li>php-mcrypt</li>
<li>php-gd</li>
<li>php-composer</li>
<li>git</li>
<li>curl</li>
<li>openssl</li>
<li>mariadb</li>
</ul>

<p>First update the system:</p>

<pre><code>pacman -Syu
</code></pre>

<h2 id="setup-mariadb:d35f1845b52303c388554e725b683ac8">Setup MariaDB</h2>

<p>Installing MariaDB (<a href="https://wiki.archlinux.org/index.php/MySQL#Installation">More Information on Archlinux.org</a>
):</p>

<pre><code>pacman -S mariadb
</code></pre>

<p>When the installation is complete, run the following command to secure your installation:</p>

<pre><code>mysql_secure_installation
</code></pre>

<p>Next, we need to create a database for our Invoice Ninja instance.</p>

<pre><code>mysql -u root -p
MariaDB [(none)]&gt; CREATE DATABASE ininja;
MariaDB [(none)]&gt; GRANT ALL PRIVILEGES ON ininja.* TO 'ininjauser'@'localhost' IDENTIFIED BY 'ininjauser_passwd';
MariaDB [(none)]&gt; FLUSH PRIVILEGES;
MariaDB [(none)]&gt; \q
</code></pre>

<h2 id="install-and-configure-php-and-nginx:d35f1845b52303c388554e725b683ac8">Install and configure PHP and Nginx</h2>

<p>You should install Nginx, PHP and all necessary extensions:</p>

<pre><code>pacman -S nginx php php-mcrypt php-gd php-composer
</code></pre>

<p>Uncomment the following Modules for PHP <code>vim /etc/php/php.ini</code>:</p>

<pre><code>extension=curl.so
extension=gd.so
extension=gmp.so
extension=iconv.so 
extension=mcrypt.so 
extension=pdo_mysql.so
extension=zip.so
</code></pre>

<h3 id="setup-nginx:d35f1845b52303c388554e725b683ac8">Setup Nginx</h3>

<p>Generate SSL certificate:</p>

<div class="highlight" style="background: #f0f0f0"><pre style="line-height: 125%"><span></span>mkdir -p /etc/nginx/ssl
<span style="color: #007020">cd</span> /etc/nginx/ssl
openssl genrsa -des3 -passout pass:x -out ininja.pass.key 2048
openssl rsa -passin pass:x -in ininja.pass.key -out ininja.key
rm ininja.pass.key
openssl req -new -key ininja.key -out ininja.csr
openssl x509 -req -days <span style="color: #40a070">365</span> -in ininja.csr -signkey ininja.key -out ininja.crt
</pre></div>


<p>Create a new Nginx Serverblock <code>vim /etc/nginx/sites-availeble/invoiceninja</code>:</p>

<div class="highlight" style="background: #f0f0f0"><pre style="line-height: 125%"><span></span><span style="color: #007020; font-weight: bold">server</span> {
    <span style="color: #007020; font-weight: bold">listen</span>  <span style="color: #40a070">80</span>;
    <span style="color: #007020; font-weight: bold">listen</span>  <span style="color: #4070a0">[::]:80</span> <span style="color: #4070a0">ipv6only=on</span>;
    <span style="color: #007020; font-weight: bold">server_name</span> <span style="color: #4070a0">my_invoiceninja.domain.tld</span>;
    
    <span style="color: #60a0b0; font-style: italic"># Return all requests to https</span>
    <span style="color: #007020; font-weight: bold">return</span>  <span style="color: #4070a0">https://</span><span style="color: #bb60d5">$host$request_uri</span>;
}
<span style="color: #007020; font-weight: bold">server</span> {
    <span style="color: #007020; font-weight: bold">listen</span>  <span style="color: #40a070">443</span>;
    <span style="color: #007020; font-weight: bold">listen</span>  <span style="color: #4070a0">[::]:443</span> <span style="color: #4070a0">ipv6only=on</span>;
    <span style="color: #007020; font-weight: bold">server_name</span> <span style="color: #4070a0">my_invoiceninja.domain.tld</span>;
    
    <span style="color: #007020; font-weight: bold">ssl</span> <span style="color: #60add5">on</span>;
    <span style="color: #007020; font-weight: bold">ssl_certificate</span>     <span style="color: #4070a0">/etc/nginx/ssl/ininja.crt</span>;
    <span style="color: #007020; font-weight: bold">ssl_certificate_key</span> <span style="color: #4070a0">/etc/nginx/ssl/ininja.key</span>;
    <span style="color: #007020; font-weight: bold">ssl_session_timeout</span> <span style="color: #40a070">5m</span>;

    <span style="color: #007020; font-weight: bold">ssl_ciphers</span>                 <span style="color: #4070a0">&#39;AES128+EECDH:AES128+EDH:!aNULL&#39;</span>;
    <span style="color: #007020; font-weight: bold">ssl_protocols</span>               <span style="color: #4070a0">TLSv1</span> <span style="color: #4070a0">TLSv1.1</span> <span style="color: #4070a0">TLSv1.2</span>;
    <span style="color: #007020; font-weight: bold">ssl_prefer_server_ciphers</span>   <span style="color: #60add5">on</span>;
    
    <span style="color: #007020; font-weight: bold">charset</span> <span style="color: #4070a0">utf-8</span>; 
    
    <span style="color: #007020; font-weight: bold">root</span> <span style="color: #4070a0">/srv/http/your_ninja_site/public</span>;
    <span style="color: #007020; font-weight: bold">index</span> <span style="color: #4070a0">index.php</span> <span style="color: #4070a0">index.html</span> <span style="color: #4070a0">index.htm</span>;
    
    <span style="color: #60a0b0; font-style: italic">## Invoiceninja Settings</span>
    <span style="color: #007020; font-weight: bold">location</span> <span style="color: #4070a0">/</span> {
        <span style="color: #007020; font-weight: bold">try_files</span> <span style="color: #bb60d5">$uri</span> <span style="color: #bb60d5">$uri/</span> <span style="color: #4070a0">/index.php?</span><span style="color: #bb60d5">$query_string</span>;
    }
    
    <span style="color: #007020; font-weight: bold">location</span> = <span style="color: #4070a0">/favicon.ico</span> { <span style="color: #007020; font-weight: bold">access_log</span> <span style="color: #60add5">off</span>; <span style="color: #007020; font-weight: bold">log_not_found</span> <span style="color: #60add5">off</span>; }
    <span style="color: #007020; font-weight: bold">location</span> = <span style="color: #4070a0">/robots.txt</span>  { <span style="color: #007020; font-weight: bold">access_log</span> <span style="color: #60add5">off</span>; <span style="color: #007020; font-weight: bold">log_not_found</span> <span style="color: #60add5">off</span>; }
    
    <span style="color: #007020; font-weight: bold">access_log</span>  <span style="color: #4070a0">/var/log/nginx/ininja.access.log</span>;
    <span style="color: #007020; font-weight: bold">error_log</span>   <span style="color: #4070a0">/var/log/nginx/ininja.error.log</span>;
    
    <span style="color: #007020; font-weight: bold">sendfile</span> <span style="color: #60add5">off</span>;
    
    <span style="color: #007020; font-weight: bold">location</span> ~ <span style="color: #235388">/\.ht</span> {
        <span style="color: #007020; font-weight: bold">deny</span> <span style="color: #4070a0">all</span>; 
    }
    
    <span style="color: #60a0b0; font-style: italic">## FastCGI Setting</span>
    <span style="color: #007020; font-weight: bold">location</span> ~ <span style="color: #235388">\.php$</span> {
        <span style="color: #007020; font-weight: bold">fastcgi_split_path_info</span> <span style="color: #4070a0">^(.+\.php)(/.+)</span>$;
        <span style="color: #007020; font-weight: bold">if</span> <span style="color: #4070a0">(!-f</span> <span style="color: #bb60d5">$document_root$fastcgi_script_name</span><span style="color: #4070a0">)</span> {
            <span style="color: #007020; font-weight: bold">return</span> <span style="color: #40a070">404</span>;
        }
        <span style="color: #60a0b0; font-style: italic"># NOTE: You should have &quot;cgi.fix_pathinfo = 0;&quot; in php.ini</span>
        
        <span style="color: #007020; font-weight: bold">fastcgi_pass</span> <span style="color: #4070a0">unix:/run/php-fpm/php-fpm.sock</span>;
        <span style="color: #007020; font-weight: bold">fastcgi_read_timeout</span> <span style="color: #40a070">30m</span>;
        <span style="color: #007020; font-weight: bold">fastcgi_param</span> <span style="color: #4070a0">PATH_INFO</span> <span style="color: #bb60d5">$fastcgi_path_info</span>;
        <span style="color: #007020; font-weight: bold">fastcgi_param</span> <span style="color: #4070a0">SCRIPT_FILENAME</span> <span style="color: #bb60d5">$document_root$fastcgi_script_name</span>;
        <span style="color: #007020; font-weight: bold">fastcgi_index</span> <span style="color: #4070a0">index.php</span>;
        <span style="color: #007020; font-weight: bold">include</span> <span style="color: #4070a0">/etc/nginx/fastcgi_params</span>;
    }
}
</pre></div>


<p>Activate the server block by creating a symbolic link:
<div class="highlight" style="background: #f0f0f0"><pre style="line-height: 125%"><span></span>ln -s /etc/nginx/sites-available/your_ininja_site /etc/nginx/sites-enabled/your_ininja_site
</pre></div>
</p>

<h3 id="enable-php-and-nginx:d35f1845b52303c388554e725b683ac8">Enable PHP and Nginx</h3>

<pre><code>systemctl start php-fpm
systemctl start nginx
</code></pre>

<h2 id="install-invoice-ninja:d35f1845b52303c388554e725b683ac8">Install Invoice Ninja</h2>

<p>Create a root directory for your application.</p>

<pre><code>mkdir -p /srv/http/your_ninja_site
</code></pre>

<p>Clone the project repository from GitHub:</p>

<pre><code>git clone https://github.com/hillelcoren/invoice-ninja.git /srv/http/your_ininja_site
cd  /srv/http/your_ininja_site
</code></pre>

<p>Install all dependencies:</p>

<pre><code>composer install
</code></pre>

<p>Set the environment to production:</p>

<pre><code>cp .env.example .env
</code></pre>

<p>Open the database.php file and edit the database settings <code>vim config/database.php</code>:</p>

<p><div class="highlight" style="background: #f0f0f0"><pre style="line-height: 125%"><span></span><span style="color: #4070a0">&#39;mysql&#39;</span> <span style="color: #666666">=&gt;</span> [
        <span style="color: #4070a0">&#39;driver&#39;</span>    <span style="color: #666666">=&gt;</span> <span style="color: #4070a0">&#39;mysql&#39;</span>,
        <span style="color: #4070a0">&#39;host&#39;</span>      <span style="color: #666666">=&gt;</span> <span style="color: #4070a0">&#39;localhost&#39;</span>,
        <span style="color: #4070a0">&#39;database&#39;</span>  <span style="color: #666666">=&gt;</span> <span style="color: #4070a0">&#39;ininja&#39;</span>,
        <span style="color: #4070a0">&#39;username&#39;</span>  <span style="color: #666666">=&gt;</span> <span style="color: #4070a0">&#39;ininjauser&#39;</span>,
        <span style="color: #4070a0">&#39;password&#39;</span>  <span style="color: #666666">=&gt;</span> <span style="color: #4070a0">&#39;ininjauser_passwd&#39;</span>,
        <span style="color: #4070a0">&#39;charset&#39;</span>   <span style="color: #666666">=&gt;</span> <span style="color: #4070a0">&#39;utf8&#39;</span>,
        <span style="color: #4070a0">&#39;collation&#39;</span> <span style="color: #666666">=&gt;</span> <span style="color: #4070a0">&#39;utf8_unicode_ci&#39;</span>,
        <span style="color: #4070a0">&#39;prefix&#39;</span>    <span style="color: #666666">=&gt;</span> <span style="color: #4070a0">&#39;&#39;</span>,
        ],
</pre></div>
</p>

<p>Run database migrations and seed the database with sample data:</p>

<pre><code>php artisan migrate
php artisan db:seed
</code></pre>

<p>Generate a new application key:</p>

<pre><code>php artisan key:generate
</code></pre>

<p>Insert the generated key in the configfile <code>vim config/app.php</code>:</p>

<pre><code>'key' =&gt; env('APP_KEY', '2DAdHIDKts85n6hTX82mb4GrQpX2TXZ2'),
</code></pre>

        <ul class="taglist">
          <li>Test </li>
          <li>Article</li>
          <li>WordPresss</li>
        </ul>
        <hr>
        <p class="author">Author Name</p>
      </article>
    </main>




<footer role="contentinfo" class="footer-2">
  <ul>
    <li><a href="javascript:void(0)">About</a></li>
    <li><a href="javascript:void(0)">Contact</a></li>
  </ul>
  <div class="footer-secondary-links">
    <ul>
      <li><a href="javascript:void(0)">Impressum und Disclaimer</a></li>
      <li><a href="javascript:void(0)">Datenschutz</a></li>
    </ul>
  </div>
</footer>
</body>
<script src="js/dist.js"></script>
</html>

